{"version":3,"file":"js/626.005381df.js","mappings":"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","sources":["webpack://toutiao-m/./src/views/search/search.vue","webpack://toutiao-m/./src/views/search/components/search-history.vue","webpack://toutiao-m/src/views/search/components/search-history.vue","webpack://toutiao-m/./src/views/search/components/search-history.vue?8ea9","webpack://toutiao-m/./src/views/search/components/search-history.vue?e2fe","webpack://toutiao-m/./src/views/search/components/search-suggestion.vue","webpack://toutiao-m/src/views/search/components/search-suggestion.vue","webpack://toutiao-m/./src/views/search/components/search-suggestion.vue?f1b1","webpack://toutiao-m/./src/views/search/components/search-suggestion.vue?9884","webpack://toutiao-m/./src/views/search/components/search-result.vue","webpack://toutiao-m/src/views/search/components/search-result.vue","webpack://toutiao-m/./src/views/search/components/search-result.vue?eb8a","webpack://toutiao-m/./src/views/search/components/search-result.vue?b3d2","webpack://toutiao-m/src/views/search/search.vue","webpack://toutiao-m/./src/views/search/search.vue?aa84","webpack://toutiao-m/./src/views/search/search.vue?e193"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-container\"},[_c('form',{attrs:{\"action\":\"/\"}},[_c('van-search',{attrs:{\"background\":\"#3296Fa\",\"show-action\":\"\",\"placeholder\":\"请输入搜索关键词\"},on:{\"search\":_vm.onSearch,\"cancel\":_vm.onCancel,\"focus\":function($event){_vm.isResultShow = false}},model:{value:(_vm.searchText),callback:function ($$v) {_vm.searchText=$$v},expression:\"searchText\"}})],1),(_vm.isResultShow)?_c('SearchResult',{attrs:{\"searchText\":_vm.searchText}}):(_vm.searchText)?_c('SearchSuggestion',{attrs:{\"searchText\":_vm.searchText},on:{\"search\":_vm.onSearch}}):_c('SearchHistroy',{attrs:{\"serchHistories\":_vm.serchHistories},on:{\"clearAll\":function($event){_vm.serchHistories=[]},\"search\":_vm.onSearch,\"clearHistory\":_vm.onClearHistory}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-histroy\"},[_c('van-cell',{attrs:{\"title\":\"搜素历史\"},scopedSlots:_vm._u([{key:\"right-icon\",fn:function(){return [(_vm.isDeleteShow)?[_c('span',{staticStyle:{\"margin-right\":\"5px\"},on:{\"click\":function($event){return _vm.clearAll()}}},[_vm._v(\"全部删除\")]),_c('span',{on:{\"click\":function($event){_vm.isDeleteShow=false}}},[_vm._v(\"完成\")])]:_c('van-icon',{staticClass:\"delete-icon\",attrs:{\"name\":\"delete\"},on:{\"click\":function($event){_vm.isDeleteShow=true}}})]},proxy:true}])}),_vm._l((_vm.serchHistories),function(value,index){return _c('van-cell',{key:index,attrs:{\"title\":value},on:{\"click\":function($event){return _vm.onClearHistory(value,index)}},scopedSlots:_vm._u([(_vm.isDeleteShow)?{key:\"right-icon\",fn:function(){return [_c('van-icon',{staticClass:\"delete-icon\",attrs:{\"name\":\"close\"}})]},proxy:true}:null],null,true)})})],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"search-histroy\">\r\n<van-cell title=\"搜素历史\" >\r\n<template #right-icon>\r\n  <!-- template -->\r\n  <template v-if=\"isDeleteShow\">\r\n    <span style=\"margin-right: 5px\" @click=\"clearAll()\">全部删除</span>\r\n    <span @click=\"isDeleteShow=false\">完成</span>\r\n  </template>\r\n<!-- 垃圾桶图标 -->\r\n<van-icon name=\"delete\" class=\"delete-icon\" v-else @click=\"isDeleteShow=true\"\r\n/>\r\n</template>\r\n</van-cell>\r\n\r\n<!-- 需要一个历史列表数组 -->\r\n<van-cell v-for=\"(value,index) in serchHistories\"\r\n@click=\"onClearHistory(value,index)\"\r\n:key=\"index\" :title=\"value\">\r\n\r\n<template #right-icon v-if=\"isDeleteShow\">\r\n<van-icon name=\"close\" class=\"delete-icon\" />\r\n</template>\r\n</van-cell>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n/* 谁的业务写在谁身上。但是如果该业务受到其他功能影响，无法通过常规思路时，尝试把业务中受到影响的部分放到其影响源上 */\r\nexport default {\r\n  name: 'SearchHistroy',\r\n  props: {\r\n    serchHistories: {\r\n      type: Array,\r\n      default: () => []\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      isDeleteShow: false // 控制删除状态的互斥\r\n    }\r\n  },\r\n  methods: {\r\n    // 全部删除\r\n    clearAll () {\r\n      // 调用父组件的方法\r\n      this.$emit('clearAll')\r\n    },\r\n    // 单个删除\r\n    onClearHistory (value, index) {\r\n      // 判断是否是删除状态\r\n      if (this.isDeleteShow) {\r\n        // 删除历史\r\n        this.$emit('clearHistory', index)\r\n      } else {\r\n        // 不是删除状态则进入搜素\r\n        this.$emit('search', value)\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.search-histroy{\r\n  .delete-icon{\r\n       font-size: 28px;\r\n       line-height: 48px;\r\n      }\r\n}\r\n</style>\r\n","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search-history.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search-history.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./search-history.vue?vue&type=template&id=0d8e664e&scoped=true&\"\nimport script from \"./search-history.vue?vue&type=script&lang=js&\"\nexport * from \"./search-history.vue?vue&type=script&lang=js&\"\nimport style0 from \"./search-history.vue?vue&type=style&index=0&id=0d8e664e&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0d8e664e\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-suggestion\"},_vm._l((_vm.suggestionList),function(item,index){return _c('van-cell',{key:index,attrs:{\"icon\":\"search\"},scopedSlots:_vm._u([{key:\"title\",fn:function(){return [_c('span',{domProps:{\"innerHTML\":_vm._s(_vm.highlight(item))}})]},proxy:true}],null,true)})}),1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"search-suggestion\">\r\n    <van-cell\r\nv-for=\"(item,index) in suggestionList\"\r\n:key=\"index\"\r\n icon=\"search\">\r\n <template #title>\r\n    <span v-html=\"highlight(item)\"></span>\r\n </template>\r\n </van-cell>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getSearchSuggestionsAPI } from '../../../api/index.js'\r\n// 引入防抖方法\r\nimport { debounce } from 'lodash'\r\n\r\n// 手写防抖(面试使用)\r\n/* function myDebounce (callback, time) {\r\n  // 通过闭包延迟时间timer的时间周期\r\n  let timer = null// 计时器\r\n  // 高阶函数,一个函数返回另一个函数\r\n  return function (val) {\r\n    const that = this\r\n    if (timer) {\r\n      return clearTimeout(timer)\r\n    }\r\n    timer = clearTimeout(() => {\r\n      callback.call(that, val)\r\n    }, 200)\r\n  }\r\n} */\r\nexport default {\r\n  name: 'SearchSuggestion',\r\n  props: {\r\n    searchText: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      suggestionList: [] // 联想列表数据\r\n    }\r\n  },\r\n  watch: {\r\n    /* 普通监听输入第一个字符不会触发监听 */\r\n    searchText: {\r\n      handler: debounce(function (newValue) {\r\n      // 调用查询联想列表方法\r\n        this.loadSearchSuggestion(newValue)\r\n      }, 200),\r\n      immediate: true // 首次监听触发\r\n    }\r\n  },\r\n  methods: {\r\n    async loadSearchSuggestion (newVal) {\r\n      try {\r\n        const { data: res } = await getSearchSuggestionsAPI(newVal)\r\n        console.log(res)\r\n        if (res.data.options && res.data.options[0] == null) {\r\n        // 判断有无options数组，并且数组的第0个1元素是否为null\r\n          res.data.options[0] = this.searchText\r\n        }\r\n        // 实现高亮文字结构的处理\r\n        // 方法1：正则表达式替换  \\正则表达式\\+replace\r\n        /* const list = res.data.options.map(item => {\r\n          // 1.设置关键字高亮文本样式\r\n          const highlightStr = `<span style=\"color:red\">${newVal}</span>`\r\n          // 2.根据输入框内容创建正则规则\r\n          const reg = new RegExp(newVal, 'gi')\r\n          // 通过正则和replace进行文本替换\r\n          return item.replace(reg, highlightStr)\r\n        })\r\n        this.suggestionList = list */\r\n        // 方法2：split与join结合使用\r\n        /*    const list = res.data.options.map(item => {\r\n          // 1.设置关键字高亮文本样式\r\n          const highlightStr = `<span style=\"color:red\">${newVal}</span>`\r\n          // 2.通过split方法将目标字符串拆分成数组\r\n          // 3.通过join方法，将highlightStr拼接到某个元素之间\r\n          return item.split(newVal).join(highlightStr)\r\n          this.suggestionList = list\r\n}) */\r\n        this.suggestionList = res.data.options\r\n      } catch (error) {\r\n        this.$toast('获取列表失败')\r\n      }\r\n    },\r\n    highlight (item) {\r\n      // 1.设置关键字的高亮文本样式\r\n      const highlightStr = `<span style=\"color:red\">${this.searchText}</span>`\r\n      // 2.通过split方法将目标字符串拆分成数组\r\n      // 3.通过join方法，将highlightStr拼接到某个元素之间\r\n      return item.split(this.searchText).join(highlightStr)\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search-suggestion.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search-suggestion.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./search-suggestion.vue?vue&type=template&id=03ba1cbe&scoped=true&\"\nimport script from \"./search-suggestion.vue?vue&type=script&lang=js&\"\nexport * from \"./search-suggestion.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"03ba1cbe\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"search-result\"},[_c('van-list',{attrs:{\"finished\":_vm.finished,\"finished-text\":\"没有更多了\",\"error\":_vm.error,\"error-text\":\"请求失败，点击重新加载\"},on:{\"update:error\":function($event){_vm.error=$event},\"load\":_vm.onLoad},model:{value:(_vm.loading),callback:function ($$v) {_vm.loading=$$v},expression:\"loading\"}},_vm._l((_vm.list),function(item){return _c('van-cell',{key:item.art_id,attrs:{\"title\":item.title}})}),1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"search-result\">\r\n<van-list\r\n  v-model=\"loading\"\r\n  :finished=\"finished\"\r\n  finished-text=\"没有更多了\"\r\n  :error.sync = \"error\"\r\n  error-text=\"请求失败，点击重新加载\"\r\n  @load=\"onLoad\"\r\n>\r\n  <van-cell v-for=\"item in list\" :key=\"item.art_id\" :title=\"item.title\" />\r\n</van-list>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { getSearchResultAPI } from '../../../api/index.js'\r\nexport default {\r\n  name: 'SearchResult',\r\n  props: {\r\n    searchText: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  data () {\r\n    return {\r\n      page: 1, // 当前页码\r\n      perPage: 20, // 每页的请求数量\r\n      list: [],\r\n      loading: false,\r\n      finished: false,\r\n      error: false\r\n    }\r\n  },\r\n  methods: {\r\n    async onLoad () {\r\n    // 1.请求获取更新数据\r\n      try {\r\n        const { data: res } = await getSearchResultAPI({\r\n          page: this.page, // 页码\r\n          per_page: this.perPage, // 每页数量\r\n          q: this.searchText\r\n        })\r\n        // 2.将数据添加到列表中\r\n        console.log(res.data.results)\r\n        this.list.push(...res.data.results)\r\n        // 3.设置加载状态的关闭\r\n        this.loading = false\r\n        // 4.判断数据是否完全加载完毕  ---finnished的状态调整\r\n        if (res.data.results.length) {\r\n          this.page++\r\n        } else {\r\n          this.finished = true\r\n        }\r\n      } catch (error) {\r\n        this.error = true\r\n        this.loading = false\r\n        this.$toast('请求失败，请稍后重试')\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n\r\n</style>\r\n","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search-result.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search-result.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./search-result.vue?vue&type=template&id=3f65f0b9&scoped=true&\"\nimport script from \"./search-result.vue?vue&type=script&lang=js&\"\nexport * from \"./search-result.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3f65f0b9\",\n  null\n  \n)\n\nexport default component.exports","<template>\r\n  <div class=\"search-container\">\r\n<!-- 顶部搜索页面 -->\r\n<!-- zaivan-search外层添加from标签，且action属性不为空既可以在输入法中显示搜素按钮 -->\r\n<form action=\"/\">\r\n<van-search\r\n  v-model=\"searchText\"\r\n  background=\"#3296Fa\"\r\n  show-action\r\n  placeholder=\"请输入搜索关键词\"\r\n @search=\"onSearch\"\r\n    @cancel=\"onCancel\"\r\n    @focus=\"isResultShow = false\"\r\n/>\r\n</form>\r\n<!-- 搜索结果 -->\r\n<SearchResult v-if=\"isResultShow\" :searchText=\"searchText\"></SearchResult>\r\n<!-- 联想列表 -->\r\n<SearchSuggestion v-else-if=\"searchText\" :searchText=\"searchText\"\r\n@search=\"onSearch\"></SearchSuggestion>\r\n<!-- 搜素历史 -->\r\n<!-- 组件的ref可以让父组件去调用子组件的方法，或者变量 -->\r\n<SearchHistroy v-else :serchHistories=\"serchHistories\"\r\n@clearAll=\"serchHistories=[]\" @search=\"onSearch\" @clearHistory=\"onClearHistory\"></SearchHistroy>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport SearchHistroy from './components/search-history.vue'\r\nimport SearchSuggestion from './components/search-suggestion.vue'\r\nimport SearchResult from './components/search-result.vue'\r\nimport { getItem, setItem } from '../../utils/storage.js'\r\nexport default {\r\n  name: 'SearchIndex',\r\n  components: {\r\n    SearchHistroy,\r\n    SearchSuggestion,\r\n    SearchResult\r\n  },\r\n  data () {\r\n    return {\r\n      // 搜索框文本\r\n      searchText: '',\r\n      // 是否展示搜索结果\r\n      isResultShow: false,\r\n      // serchHistories: [],// 搜索历史列表数组\r\n      serchHistories: getItem('TOUTIAO_HISTORY') || [] // 去看本地缓存中是否存在历史列表数据\r\n    }\r\n  },\r\n  watch: {\r\n    serchHistories: {\r\n      handler (newVal) {\r\n        // 将列表数据放入本地缓存中\r\n        setItem('TOUTIAO_HISTORY', newVal)\r\n      },\r\n      deep: true\r\n    }\r\n  },\r\n  methods: {\r\n    // 搜索事件\r\n    // value表示输入框中的值\r\n    onSearch (value) {\r\n      // 将当前的内容赋值给输入框\r\n      this.searchText = value\r\n      // 主动开启搜索结果组件\r\n      this.isResultShow = true\r\n\r\n      // 将搜索框的内容放到搜索历史列表中\r\n      this.onAddTarget(value)\r\n    },\r\n\r\n    // 添加历史数据\r\n    onAddTarget (value) {\r\n      // 判断原数组中有没有该字符串 indexof（）\r\n      const index = this.serchHistories.indexOf(value)\r\n\r\n      if (index !== -1) {\r\n        // 列表中有该元素则删除\r\n        this.serchHistories.splice(index, 1)\r\n      }\r\n      // 将value更新到列表的最顶端\r\n      this.serchHistories.unshift(value)\r\n    },\r\n    // 删除单独历史\r\n    onClearHistory (index) {\r\n      this.serchHistories.splice(index, 1)\r\n    },\r\n    // 关闭事件\r\n    onCancel (value) {\r\n      this.$toast('取消搜索')\r\n      // 返回前一个路由页面\r\n      this.$router.back()\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.search-container{\r\n.van-search__action{\r\ncolor:#fff;\r\n}\r\n}\r\n</style>\r\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./search.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./search.vue?vue&type=template&id=e1e4ae16&scoped=true&\"\nimport script from \"./search.vue?vue&type=script&lang=js&\"\nexport * from \"./search.vue?vue&type=script&lang=js&\"\nimport style0 from \"./search.vue?vue&type=style&index=0&id=e1e4ae16&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"e1e4ae16\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticClass","attrs","on","onSearch","onCancel","$event","isResultShow","model","value","searchText","callback","$$v","expression","serchHistories","onClearHistory","staticRenderFns","scopedSlots","_u","key","fn","isDeleteShow","staticStyle","clearAll","_v","proxy","_l","index","name","props","type","default","data","methods","component","suggestionList","item","domProps","_s","highlight","watch","handler","immediate","console","res","finished","error","onLoad","loading","list","art_id","title","page","perPage","per_page","q","components","SearchHistroy","SearchSuggestion","SearchResult","setItem","deep","onAddTarget"],"sourceRoot":""}